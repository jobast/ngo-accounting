{% extends "base.html" %}

{% block title %}Sortie Immobilisation - CREATES{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2><i class="bi bi-box-arrow-right"></i> Sortie d'Immobilisation</h2>
    <a href="{{ url_for('detail_immobilisation', id=immobilisation.id) }}" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Retour
    </a>
</div>

<div class="card">
    <div class="card-body">
        <div class="alert alert-warning">
            <i class="bi bi-exclamation-triangle"></i>
            <strong>Attention:</strong> Cette opération est irréversible. L'immobilisation sera marquée comme sortie.
        </div>

        <div class="row mb-4">
            <div class="col-md-6">
                <p><strong>Code:</strong> {{ immobilisation.code }}</p>
                <p><strong>Désignation:</strong> {{ immobilisation.designation }}</p>
                <p><strong>Valeur d'acquisition:</strong> {{ "{:,.0f}".format(immobilisation.valeur_acquisition) }} FCFA</p>
            </div>
            <div class="col-md-6">
                <p><strong>Amortissement cumulé:</strong> {{ "{:,.0f}".format(immobilisation.cumul_amortissement) }} FCFA</p>
                <p><strong>Valeur Nette Comptable:</strong> {{ "{:,.0f}".format(immobilisation.valeur_nette_comptable) }} FCFA</p>
            </div>
        </div>

        <form method="POST">
            <div class="row">
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="date_sortie" class="form-label">Date de sortie *</label>
                        <input type="date" class="form-control" id="date_sortie" name="date_sortie" value="{{ today }}" required>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="motif_sortie" class="form-label">Motif *</label>
                        <select class="form-select" id="motif_sortie" name="motif_sortie" required>
                            <option value="">-- Sélectionner --</option>
                            <option value="cede">Cession (vente)</option>
                            <option value="rebut">Mise au rebut</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="mb-3">
                        <label for="valeur_cession" class="form-label">Valeur de cession (si vente)</label>
                        <div class="input-group">
                            <input type="number" step="1" class="form-control" id="valeur_cession" name="valeur_cession">
                            <span class="input-group-text">FCFA</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="d-flex justify-content-end gap-2">
                <a href="{{ url_for('detail_immobilisation', id=immobilisation.id) }}" class="btn btn-outline-secondary">Annuler</a>
                <button type="submit" class="btn btn-danger">
                    <i class="bi bi-check-lg"></i> Confirmer la sortie
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
